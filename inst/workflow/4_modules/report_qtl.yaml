meta:
  Type: Report
  ID: report_qtl
  Output: html
  Name: QTL Report
  Description: A report summarizing QTL
spec:
  Mapped_EXCLUSION:
    _all:
      required: true
  Reporting_Results_Longitudinal:
    _all:
      required: true
  Reporting_Groups:
    _all:
      required: true
steps:
  # add listings
  - output: qtl0001
    name: gsm.core::RunQuery
    params:
      df: Mapped_EXCLUSION
      strQuery: "SELECT * FROM df"
  - output: reporting_listings
    names: list
    params:
      'qtl0001': qtl0001
  - output: all_reportingResults
    name: =
    params:
      lhs: all_reportingResults
      rhs: Reporting_Results_Longitudinal
  - output: all_reportingGroups
    name: =
    params:
      lhs: all_reportingGroups
      rhs: Reporting_Groups
  # Define the output directory for the report.
  - output: strSnapshotDate
    name: pull
    params:
      .data: Reporting_Results_Longitudinal
      var: SnapshotDate
  - output: strSnapshotDate
    name: max
    params:
      ...: strSnapshotDate
  - output: strOutputDir
    name: file.path
    params:
      outputs: outputs
      SnapshotDate: strSnapshotDate
  - output: strOutputDir
    name: normalizePath
    params:
      path: strOutputDir
  - output: Report
    name: gsm.qtl::Report_QTL
    params:
      dfResults: all_reportingResults
      dfGroups: all_reportingGroups
      lListings: reporting_listings
      strOutputDir: strOutputDir
      strOutputFile: ID
