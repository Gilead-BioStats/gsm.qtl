---
title: "QTL0002 - Premature Study Discontinuation"
---

# QTL0002 - Premature Study Discontinuation

## Study Overview
```{r, echo=FALSE}
QTL_Overview(dfResults = qtl0002_params$dfResults,
             dSnapshot = qtl0002_params$latest_snapshot,
             strNum = "Subjects Discontinued - Study",
             strDenom = "Total Enrolled", 
             strQTL = "Current Premature Discontinuation Rate")
```

## Time Series Chart
```{r, echo=FALSE, results='asis', fig.height=4}
QTL_lineplot(dfResults = qtl0002_params$dfResults, strQTL = "Premature Discontinuation Rate")
```

## Bar Charts {.tabset .tabset-pills}

### Site
```{r, echo = FALSE, results = 'asis', fig.height=4}
discontinuation_groupBar(df = qtl0002_params$dfListing, varGroupID = invid, strGroupLabel = "Site")
```

### Country
```{r, echo = FALSE, results = 'asis', fig.height=4}
discontinuation_groupBar(df = qtl0002_params$dfListing, varGroupID = country, strGroupLabel = "Country")
```

### Reasons
```{r, echo = FALSE, results = 'asis', fig.height=4}
discontinuation_reasonBar(df = qtl0002_params$dfListing)
```

### Reasons/Site
```{r, echo = FALSE, results = 'asis', fig.height=4}
reasons_groupBar(df = qtl0002_params$dfListing, varGroupID = invid, strGroupLabel = "Site")
```

### Reasons/Country
```{r, echo = FALSE, results = 'asis', fig.height=4}
reasons_groupBar(df = qtl0002_params$dfListing, varGroupID = country, strGroupLabel = "Country")
```

## Discontinuation Listing
```{r, echo = FALSE}
discontinuation_listing <- qtl0002_params$dfListing %>% 
  select(subjid, invid, country, compreas) %>% 
  rename(
    `Subject ID` = subjid,
    `Site ID` = invid,
    `Country` = country,
    `Discontinuation Reason` = compreas
  )

# output the listing in the html
discontinuation_listing %>% 
  gt() %>% 
  scrollable_gt(., height = "500px", min_table_width = "100px")

csv_txt <- paste(capture.output(write.csv(discontinuation_listing, row.names = FALSE)), collapse = "\n")# turn into a data-URI (single-file HTML friendly)
href <- base64enc::dataURI(charToRaw(csv_txt), mime = "text/csv;charset=utf-8")

knitr::asis_output(
  sprintf('<p><a class="btn btn-primary" download="discontinuation_listing.csv" href="%s">
            ⬇️ Download CSV
          </a></p>', href)
)
```
