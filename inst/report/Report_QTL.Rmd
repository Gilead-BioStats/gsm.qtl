---
output:
  html_document:
    mathjax: null
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    css: styles.css
params:
  dfResults: NA
  dfGroups: NA
  lListings: NA
---

```{r setup, include=FALSE} 
library(dplyr)
library(gsm.kri)
library(gsm.qtl)
library(ggplot2)
library(plotly)
library(gt)
library(htmltools)
library(knitr)

knitr::opts_chunk$set(warning = FALSE, message = FALSE)

dfResults <- params$dfResults
dfGroups <- params$dfGroups
lListings <- params$lListings
latest_snapshot = max(dfResults$SnapshotDate)
```

---
title: "QTL Overview"
subtitle: "Study: `r unique(lListings[[1]]$studyid)`"
date: "Snapshot Date: `r latest_snapshot`"
---

# QTL0001 - Ineligibility

```{r QTL0001, echo = FALSE, results = 'asis'}
# Feed and knit just QTL0001 using child rmd support
qtl0001 <- knitr::knit_child(
  system.file("report", "QTL0001.Rmd", package = "gsm.qtl"),
  envir = list(
    qtl0001_params = list(
      dfResults = dfResults %>% filter(MetricID == "Analysis_qtl0001_study"),
      dfListing = lListings$qtl0001,
      latest_snapshot = latest_snapshot
    )
  ),
  quiet = TRUE
) %>% suppressMessages %>% suppressWarnings
cat(qtl0001, sep = "\n")
```


# QTL0002 - Study Discontinuation

```{r QTL0002, echo = FALSE, results = 'asis'}
# Feed and knit just QTL0002 using child rmd support
qtl0002 <- knitr::knit_child(
  system.file("report", "QTL0002.Rmd", package = "gsm.qtl"),
  envir = list(
    qtl0002_params = list(
      dfResults = dfResults %>% filter(MetricID == "Analysis_qtl0002_study"),
      dfListing = lListings$qtl0002,
      latest_snapshot = latest_snapshot
    )
  ),
  quiet = TRUE
) %>% suppressMessages %>% suppressWarnings
cat(qtl0002, sep = "\n")
```
